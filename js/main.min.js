$(document).ready(function(){c(),f();var e,t=1,a="hard",o=[1,2,3,4,5,6,7,8,9],s=[],l=[],n=[[1,4,7],[2,5,8],[3,6,9],[1,2,3],[4,5,6],[7,8,9],[1,5,9],[3,5,7]];function r(e,t){if(t.push(e),o=o.filter(function(t){if(t!==e)return t}),t.length>=3){var a=!1;return i(e).forEach(function(e){var o=0;e.forEach(function(e){-1!==t.indexOf(e)&&o++}),3===o?a=!0:a||(o=0)}),a}}function i(e){return n.map(function(t){if(-1!==t.indexOf(e))return t}).filter(function(e){if(void 0!==e)return e})}function d(){$("td").text(""),$("td").removeClass("avoid-clicks"),t=1,$(".currentPlayer").text("Vez de: ( X )"),o=[1,2,3,4,5,6,7,8,9],s=[],l=[],$(".modal-winner").hasClass("show")&&$(".modal-winner").modal("hide")}function c(){null!==localStorage.getItem("scoreplayer1")?($(".storage").removeClass("hide").addClass("show"),$(".nostorage").removeClass("show").addClass("hide"),$(".score-player1").text(localStorage.getItem("scoreplayer1")),$(".score-player2").text(localStorage.getItem("scoreplayer2"))):($(".storage").removeClass("show").addClass("hide"),$(".nostorage").removeClass("hide").addClass("show"))}function f(){a="hard"}function h(){var e=!1;return i(l[l.length-1]).forEach(function(t){var a=0;t.forEach(function(e){-1!==l.indexOf(e)&&a++,-1!==s.indexOf(e)&&a--}),2==a&&(e=!0)}),e}$("td").click(function(n){$("td").addClass("avoid-clicks2"),setTimeout(function(){$("td").removeClass("avoid-clicks2")},1e3),""===$(this).text()&&$(this).animate({opacity:.4},200,function(){$(this).text(1===t?"X":"O"),$(this).addClass("avoid-clicks")}).animate({opacity:1},200).promise().done(function(){var d;if(d=parseInt($(this).attr("id"),10),e=r(d,1===t?s:l)){$(".modal-winner .modal-title").text((1===t?"( X )":"( O )")+" venceu!      Modo: "+("hard"===a?"Impossível":"easy"===a?"Fácil":"Multiplayer")),$(".modal-winner").modal("show");var f=localStorage.getItem("scoreplayer"+t);null!==f?(f=parseInt(f,10),f++,localStorage.setItem("scoreplayer"+t,f.toString())):(localStorage.setItem("scoreplayer"+t,"1"),localStorage.setItem("scoreplayer"+(1===t?"2":"1"),"0")),c()}else 0===o.length?($(".modal-winner .modal-title").text("Deu Velha!"),$(".modal-winner").modal("show")):1===t?(t=2,$(".currentPlayer").text("Vez de: ( O )")):(t=1,$(".currentPlayer").text("Vez de: ( X )"));n.isTrigger||e||"mp"===a||function(){var t,n;if("easy"===a)t=o[Math.floor(Math.random()*o.length)];else if("hard"===a&&(-1===s.indexOf(5)&&-1===l.indexOf(5)?t=5:1===s.length?t=1===(t=Math.floor(4*Math.random())+1)?1:2===t?3:3===t?7:9:h()?(n=l[l.length-1],i(n).forEach(function(e){e.forEach(function(e){-1!==o.indexOf(e)&&(t=e)})})):(n=s[s.length-1],i(n).forEach(function(e){var a=0;e.forEach(function(e){-1!==s.indexOf(e)&&a++}),2==a&&e.forEach(function(e){-1===s.indexOf(e)&&-1!==o.indexOf(e)&&(t=e)})})),void 0===t&&!e)){var r=0;do{if(void 0===(t=o[Math.floor(Math.random()*o.length)])||r>o.length)break;l.push(t),r++}while(!h());l.pop()}$("td#"+t).trigger("click")}()})}),$(".btn.btn-primary").click(function(){d()}),$("#mode").change(f()),$("#mobile-toggle-mp").click(function(e){$("#mobile-toggle-mp").hasClass("disabled")&&d(),$("#mobile-toggle-ia").addClass("disabled").removeClass("btn-success").addClass("btn-default"),$(this).addClass("btn-success").removeClass("btn-default").removeClass("disabled"),a="mp"}),$("#mobile-toggle-ia").click(function(e){d(),$("#mobile-toggle-mp").hasClass("disabled")?"hard"===(a=$(this).attr("mode"))?($(this).attr("mode","easy"),$(this).text("Fácil"),a="easy"):($(this).attr("mode","hard"),$(this).text("Impossível"),a="hard"):($("#mobile-toggle-mp").addClass("disabled").removeClass("btn-success").addClass("btn-default"),$(this).addClass("btn-success").removeClass("btn-default").removeClass("disabled"))})});
